---
import { type CollectionEntry, getCollection } from "astro:content";
import Layout from "../../../layouts/Layout.astro";
import { render } from "astro:content";

export async function getStaticPaths() {
  const apps = await getCollection("apps");
  return apps
    .filter((app) => !app.data.isDraft && !app.id.includes("/"))
    .map((app) => ({
      params: { slug: app.id },
      props: app,
    }));
}
type Props = CollectionEntry<"apps">;

const app = Astro.props;
const { Content } = await render(app);
const isTeletextPro = Astro.params.slug === "teletext-pro";
const privacyLinkLabel = isTeletextPro ? "Datenschutz" : "Privacy Policy";
const appStoreLinkLabel = isTeletextPro ? "Im App Store laden" : "Download on the App Store";
---

<Layout
  title={app.data.title}
  description={app.data.description}
>
  <main class="mx-auto my-12 flex max-w-xl flex-col justify-center p-4">
    <h1 class="mb-1 text-2xl font-medium">{app.data.title}</h1>
    <p class="mb-5 text-lg font-medium text-neutral-600">{app.data.description}</p>
    {app.data.appStoreUrl && (
      <p class="mb-5">
        <a href={app.data.appStoreUrl} class="text-blue-700 underline">{appStoreLinkLabel}</a>
      </p>
    )}
    <article>
      <Content />
    </article>
    <nav class="mt-8 text-sm text-neutral-500">
      <a href={`/apps/${Astro.params.slug}/privacy`} class="hover:underline">{privacyLinkLabel}</a>
    </nav>
  </main>
</Layout>
